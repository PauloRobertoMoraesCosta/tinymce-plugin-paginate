!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";a("./src/main")},{"./src/main":7}],2:[function(a,b,c){"use strict";function d(){f=$("<div/>").attr("id","dpi-test").css({position:"absolute",top:"-100%",left:"-100%",height:"1in",width:"1in",border:"red 1px solid"}),$("body").prepend(f)}function e(a){this.document=a,this._setScreenDPI()}var f;e.prototype._setScreenDPI=function(){if(d(),f[0].offsetWidth!==f[0].offsetHeight)throw new Error("FATAL ERROR: Bad Screen DPI !");this.screenDPI=f[0].offsetWidth},e.prototype.height=function(a){if(!a)throw new Error("Explicit unit for getting document height is required");var b=$("body",this.document).height();return"px"===a?b:"mm"===a?this.px2mm(b):void 0},e.prototype.px2mm=function(a){if(!this.screenDPI)throw new Error("Screen DPI is not defined. Is Display object instantied ?");return 25.4*a/this.screenDPI},e.prototype.mm2px=function(a){if(!this.screenDPI)throw new Error("Screen DPI is not defined. Is Display object instantied ?");return a*this.screenDPI/25.4},b.exports=e},{}],3:[function(a,b,c){"use strict";function d(a,b,c,d){this._content=null,this.rank=null,this.format(a),this.orientate(b),void 0!==c&&(this.rank=c),(void 0!==d||null!==d)&&this.content(d)}var e=a("../utils/page-formats"),f=function(){function a(a){this.name="InvalidOrientationLabelError",this.message=a+" is an invalid orientation label !",this.stack=(new Error).stack}return a.prototype=new Error,a}();d.prototype.content=function(a){return void 0===a?this._content:void(this._content=a)},d.prototype.append=function(a){return $(a).appendTo(this.content()),this},d.prototype.prepend=function(a){return $(a).prependTo(this.content()),this},d.prototype.orientate=function(a){var b="string"!=typeof a,c="portrait"!==a.toLowerCase()&&"paysage"!==a.toLowerCase();if(b||c)throw new f(a);this.orientation=a,"portrait"===a?(this.width=this.format()["short"],this.height=this.format()["long"]):(this.width=this.format()["long"],this.height=this.format()["short"])},d.prototype.format=function(a){if(void 0!==a){if(!e[a])throw new Error("Format "+a+" is not supported yet.");return this._format=e[a],this}return this._format},b.exports=d},{"../utils/page-formats":8}],4:[function(a,b,c){"use strict";function d(a,b,c){f=c,this._document=c.getDoc(),this._display=new g(this._document),this._defaultPage=new h(a,b),this._body=this._document.getElementsByTagName("body")}var e,f,g=a("./Display"),h=a("./Page"),i=(a("./paginator/parser"),a("./paginator/errors")),j=i.InvalidPageRankError,k=[];d.prototype.init=function(){function a(){return $("div[data-paginator-page-rank]",b._body)}var b=this,c=a(),d=q.call(this,1);c.length||($(this._body).wrapInner(d),c=a()),k=[],$.each(c,function(a,c){k.push(new h(b._defaultPage.format().label,b._defaultPage.orientation,a+1,c))})},d.prototype.getCurrentPage=function(){return e},d.prototype.getPage=function(a){try{a=Number(a)}catch(b){throw new j(a)}if(!k.length)throw new Error("Paginator pages length in null. Can't iterate on it.");var c,d=0>a-1,e=a-1>k.length;if(d||e)throw new j(a);return $.each(k,function(b,d){d.rank===a&&(c=d)}),c},d.prototype.getPages=function(){return k},d.prototype.getPrevious=function(){try{return this.getPage(this.getCurrentPage().rank-1)}catch(a){return null}},d.prototype.getNext=function(){try{return this.getPage(this.getCurrentPage().rank+1)}catch(a){return null}},d.prototype.gotoPage=function(a){function b(){function b(a,c,d){var e=a.childNodes;if(c=c?c:3,d=d?d:[],a.nodeType===c&&d.push(a),e)for(var f=0;f<e.length;f++)d=b(e[f],c,d);return d}var c,d,e,g,h;c=a.content(),d=c.length?c[0].lastChild:c.lastChild,d?(e=b(d),e.length?(g=e[e.length-1],h=g.textContent.length):(g=d,h=0)):(g=c,h=0),f.selection.setCursorLocation(g,h)}var c=e,d=this.getPage(c.rank).content(),g=this.getPage(a.rank).content();if(!a)throw new Error("Cant navigate to undefined page");a!==c&&($(d).hide("slide",{direction:"up"},200,function(){$(g).show("slide",{direction:"down"},200)}),b(),e=a,f.dom.fire(f.getDoc(),"PageChange",{fromPage:c,toPage:a}))},d.prototype.gotoFocusedPage=function(){var a=l.call(this),b=$(a).attr("data-paginator-page-rank"),c=this.getPage(b);e=c,this.gotoPage(c)},d.prototype.gotoPrevious=function(){var a=this.getPrevious();return a?this.gotoPage(a):null},d.prototype.gotoNext=function(){var a=this.getNext();return a?this.gotoPage(a):null},d.prototype.watchPage=function(){var a=o.call(this),b=p.call(this);b>a&&m.call(this)};var l=function(){var a,b,c,d=f.selection.getRng();if(b=d.startContainer,c=$(b).closest('div[data-paginator="true"]'),!c.length)throw new InvalidFocusedRangeError;return a=c[0]},m=function(){console.info("repaging...");var a=(f.selection.getRng(),$(e.content()).children()),b=a[a.length-1],c=this.getNext()||r.call(this);switch(b.nodeName){case"DIV":case"P":$(b).prependTo($(c.content())),$(c.content()).appendTo(this._body),this.gotoNext();break;default:throw alert("Une erreur est survenue dans le plugin de pagination. Merci de visionner l'erreur dans la console et de déclarer cette erreur au support «support@sirap.fr»"),new Error("Unsupported block type for repaging: "+b.nodeName)}},n=function(){var a=this;return{top:$(a._body).css("padding-top"),right:$(a._body).css("padding-right"),bottom:$(a._body).css("padding-bottom"),left:$(a._body).css("padding-left")}},o=function(){var a=Number(this._display.mm2px(this._defaultPage.height)),b=n.call(this),c=Number(b.top.split("px").join("")),d=Number(b.bottom.split("px").join("")),e=a-c-d;return Math.ceil(e-1)},p=function(){return Number($(e.content()).css("height").split("px").join(""))},q=function(a){var b=this;return $("<div>").attr({"data-paginator":!0,"data-paginator-page-rank":a}).css({"page-break-after":"always","min-height":o.call(b),background:"linear-gradient(#FFF0F5,#FFFACD)"})},r=function(a){var b,c=e?e.rank+1:1,d=q.call(this,c);return a&&$(a).appendTo(d),b=new h(this._defaultPage.format().label,this._defaultPage.orientation,c,d[0]),k.push(b),b};b.exports=d},{"./Display":2,"./Page":3,"./paginator/errors":5,"./paginator/parser":6}],5:[function(a,b,c){"use strict";function d(a){this.name="InvalidPageRankError",this.message=a+" is an invalid page rank",this.stack=(new Error).stack}function e(){this.name="InvalidFocusedRangeError",this.message="The text cursor if out of any page.",this.stack=(new Error).stack}d.prototype=new Error,e.prototype=new Error,c.InvalidPageRankError=d,c.InvalidFocusedRangeError=e},{}],6:[function(a,b,c){"use strict";b.exports={}},{}],7:[function(a,b,c){"use strict";var d=a("./classes/Paginator"),e=a("./utils/ui");tinymce.PluginManager.add("paginate",function(a){function b(a){e.updatePageRankInput(a.toPage.rank)}var c,f=!1;a.once("init",function(){c=new d("A4","portrait",a),!f&&c.init(),f=!0,e.appendNavigationButtons(c),a.dom.bind(a.getDoc(),"PageChange",b)}),a.once("change",function(){f=!!c,f&&c.init()}),a.on("change",function(){f&&c.watchPage()}),a.on("SetContent",function(){}),a.on("NodeChange",function(){if(f)try{c.gotoFocusedPage()}catch(a){console.info("Can't go to focused page now."),console.error(a.stack)}})})},{"./classes/Paginator":4,"./utils/ui":9}],8:[function(a,b,c){"use strict";function d(a,b,c){this.label=a,this["long"]=b,this["short"]=c}var e={A4:{"long":"297","short":"210"}},f=[];$.each(e,function(a,b){f[a]=new d(a,b["long"],b["short"])}),b.exports=f},{}],9:[function(a,b,c){"use strict";c.appendNavigationButtons=function(b){function c(c){var d,e=c.target.valueAsNumber,f=b.getCurrentPage().rank;if(e!==f)try{d=b.getPage(e),b.gotoPage(d)}catch(g){if(!(g instanceof a("../classes/paginator/errors").InvalidPageRankError))throw g;alert("Il n'y a pas de page #"+e),console.log($(this)),$(this).val(f)}}var d,e={},f=$("body"),g="<a></a>",h="btn glyphicon",i={background:"white",width:"100%",top:"0"};d=$("<div></div>").css({width:"60px",position:"absolute","-moz-box-shadow":"0px 0px 10px 10px #000000","-webkit-box-shadow":"0px 0px 10px 10px #000000","-o-box-shadow":"0px 0px 10px 10px #000000","box-shadow":"0px 0px 10px 10px #000000",filter:"progid:DXImageTransform.Microsoft.Shadow(color=#000000, Direction=NaN, Strength=10)","-moz-border-radius":"50%","-webkit-border-radius":"50%","border-radius":"50%",top:window.screen.height/2-35+"px",right:"40px","z-index":"999"}).appendTo(f),e.btnPrevious=$(g).attr("href","javascript:void(0)").css($.extend(i,{"border-top-left-radius":"50%","border-top-right-radius":"50%","border-bottom-left-radius":"0","border-bottom-right-radius":"0"})).addClass(h+" glyphicon-chevron-up").click(function(){b.gotoPrevious()}).appendTo(d),e.inputRank=$("<input></input>").attr("type","number").attr("id","input-rank").css({width:"100%","line-height":"30px","text-align":"center"}).change(c).appendTo(d),e.btnNext=$(g).attr("href","javascript:void(0)").css($.extend(i,{width:"100%","border-top-left-radius":"0","border-top-right-radius":"0","border-bottom-left-radius":"50%","border-bottom-right-radius":"50%"})).addClass(h+" glyphicon-chevron-down").click(function(){b.gotoNext()}).appendTo(d)},c.updatePageRankInput=function(a){$("#input-rank").val(a)}},{"../classes/paginator/errors":5}]},{},[1]);